---
layout: post
title: "SPSA: κ²μ„ AIλ¥Ό μ„ν• νλΌλ―Έν„° μλ™ μ΅°μ • κΈ°λ²•"
date:   2025-08-12 10:00:00 +0900
last_modified_at: 2025-08-12 10:00:00 +0900
tags: [SPSA, ParameterTuning, YaneuraOu, Stockfish, MachineLearning, μΌλ³Έμ¥κΈ°, μλ™νλ‹]
toc: true
---

## π“‘ **Table Of Contents**

- [1. β™ νλΌλ―Έν„° νλ‹μ μ—­μ‚¬μ™€ ν•κ³„](#history-and-limits)
  - [μλ™ νλ‹μ—μ„ λ² μ΄μ¦ μµμ ν™”κΉμ§€](#from-manual-to-bayes)
  - [μ‡ΌκΈ° AIμ™€ λ² μ΄μ¦ μµμ ν™”μ μƒμ„±](#shogi-ai-and-bayes)
- [2. β™ SPSA μ•κ³ λ¦¬μ¦: λ‹¨μν•¨μ λ―Έν•™](#spsa-algorithm)
  - [ν•µμ‹¬ μ•„μ΄λ””μ–΄](#core-idea)
  - [μ•κ³ λ¦¬μ¦ μƒμ„Έ μ„¤λ…](#algorithm-details)
- [3. β™ μ‹¤μ „ νκ³Ό μ„±κ³µ μ‚¬λ΅€](#practical-tips)
- [4. π λ§μΉλ©°](#conclusion)

---

![spsa.png](/images/posts/2025-08-12-spsa-search-params/spsa.png)

## 1. β™ νλΌλ―Έν„° νλ‹μ μ—­μ‚¬μ™€ ν•κ³„ {#history-and-limits}

### μλ™ νλ‹μ—μ„ λ² μ΄μ¦ μµμ ν™”κΉμ§€ {#from-manual-to-bayes}

κ²μ„ AIμ μ„±λ¥μ„ λμ–΄μ¬λ¦¬κΈ° μ„ν• νƒμƒ‰ νλΌλ―Έν„° μ΅°μ •μ€ μ¤λ μ™μ μ€μµλ‹λ‹¤. 2015λ…„κ²½, Ponanzaμ™€ κ°™μ€ μµκ³  μμ¤€μ μ‡ΌκΈ° AIμ΅°μ°¨ κ° νλΌλ―Έν„°λ¥Ό ν•λ‚μ”© μλ™μΌλ΅ λ³€κ²½ν•κ³  μλ§μ€ μμ²΄ λ€κµ­μ„ ν†µν•΄ μΉλ¥ μ„ ν™•μΈν•λ” κ³ λ μ‘μ—…μ„ λ°λ³µν–μµλ‹λ‹¤.

λ‹Ήμ‹ μ•Όλ„¤μ°λΌμ¤(γ‚„γ­γ†γ‚‰η‹)λ” μ΅°κΈ λ‹¤λ¥Έ μ ‘κ·Όλ²•μ„ μ‹λ„ν–μµλ‹λ‹¤. λ¨λ“  νλΌλ―Έν„°λ¥Ό λ™μ‹μ— λ¬΄μ‘μ„λ΅ μ΅°κΈμ”© λ³€κ²½ν•κ³ , κ·Έ κ²°κ³Όλ¥Ό ν†µκ³„μ μΌλ΅ μ§‘κ³„ν•μ—¬ μΉλ¥ μ΄ κ°μ„ λλ” λ°©ν–¥μΌλ΅ νλΌλ―Έν„°λ¥Ό μΌκ΄„ μ΅°μ •ν•λ”, λ§μΉ 'ν™•λ¥ μ  κ²½μ‚¬ ν•κ°•λ²•(SGD)'κ³Ό μ μ‚¬ν• λ°©μ‹μ΄μ—μµλ‹λ‹¤.

μ΄ν›„ `Hyperopt`λ‚ `Optuna`μ™€ κ°™μ€ λ² μ΄μ¦ μµμ ν™”(Bayesian Optimization) λΌμ΄λΈλ¬λ¦¬κ°€ λ“±μ¥ν•λ©° νλΌλ―Έν„° νλ‹ μλ™ν™”μ— μƒλ΅μ΄ κΈΈμ΄ μ—΄λ Έμµλ‹λ‹¤. dlshogiμ™€ κ°™μ€ μΌλ¶€ μ‡ΌκΈ° AI ν”„λ΅μ νΈμ—μ„ μ΄λ¥Ό ν™μ©ν• μμ²΄ νλ‹ μ¤ν¬λ¦½νΈλ¥Ό κ°λ°ν•κΈ°λ„ ν–μµλ‹λ‹¤.

### μ‡ΌκΈ° AIμ™€ λ² μ΄μ¦ μµμ ν™”μ μƒμ„± {#shogi-ai-and-bayes}

ν•μ§€λ§ λ² μ΄μ¦ μµμ ν™” κΈ°λ²•μ€ μ‡ΌκΈ° AI, νΉν NNUE κ³„μ—΄ μ—”μ§„μ νλΌλ―Έν„° νλ‹μ— λ„λ¦¬ μ‚¬μ©λμ§€λ” λ»ν–μµλ‹λ‹¤. κ·Έ μ΄μ λ΅ μ¶”μ •λλ” κ²ƒμ€ μ‡ΌκΈ° AI νλΌλ―Έν„°μ νΉμ„± λ•λ¬Έμ…λ‹λ‹¤.

- **κ³ μ°¨μ›μ„±**: μ΅°μ •ν•΄μ•Ό ν•  νλΌλ―Έν„°μ μκ°€ λ§¤μ° λ§μµλ‹λ‹¤.
- **λΉ„μ—°μ†μ„± λ° μ΅°κ±΄λ¶€ μμ΅΄μ„±**: νΉμ • μ΅°κ±΄μ—μ„λ§ ν™μ„±ν™”λκ±°λ‚, λ‹¤λ¥Έ νλΌλ―Έν„°μ™€ λ³µμ΅ν•κ² μ–½ν€μλ” κ²½μ°κ°€ λ§μµλ‹λ‹¤.

μ΄λ¬ν• νΉμ„±μ€ μ •κµν• ν™•λ¥  λ¨λΈμ„ κ°€μ •ν•λ” λ² μ΄μ¦ μµμ ν™”κ°€ ν¨μ¨μ μΌλ΅ μ‘λ™ν•κΈ° μ–΄λ ¤μ΄ ν™κ²½μ„ λ§λ“­λ‹λ‹¤.

---

## 2. β™ SPSA μ•κ³ λ¦¬μ¦: λ‹¨μν•¨μ λ―Έν•™ {#spsa-algorithm}

μ΄λ¬ν• μƒν™©μ—μ„ μ²΄μ¤ AI μ„Έκ³„λ¥Ό μ¤‘μ‹¬μΌλ΅ λ€μ•μΌλ΅ λ– μ¤λ¥Έ κ²ƒμ΄ λ°”λ΅ **SPSA(Simultaneous Perturbation Stochastic Approximation)** μ…λ‹λ‹¤. Stockfishμ ν…μ¤νΈ ν”„λ μ„μ›ν¬μΈ `fishtest`λ‚ `OpenBench`μ— SPSAκ°€ λ„μ…λλ©΄μ„, μ²΄μ¤ AI κ°λ°μ λ€λ¶€λ¶„μ΄ μ΄λ¥Ό ν‘μ¤€μ μΈ νλ‹ λ°©μ‹μΌλ΅ μ±„νƒν•κ² λμ—μµλ‹λ‹¤.

### ν•µμ‹¬ μ•„μ΄λ””μ–΄ {#core-idea}

SPSAμ μ•„μ΄λ””μ–΄λ” λ†€λΌμΈ μ •λ„λ΅ λ‹¨μν•©λ‹λ‹¤. λ¨λ“  νλΌλ―Έν„°λ¥Ό ν• λ²μ—, ν•μ§€λ§ κ°κΈ° λ‹¤λ¥Έ λλ¤ λ°©ν–¥μΌλ΅ μ΅°κΈμ”© ν”λ“¤μ–΄ λ³Έ λ’¤, λ” μΆ‹μ€ κ²°κ³Όλ¥Ό λ³΄μΈ λ°©ν–¥μΌλ΅ μ „μ²΄ νλΌλ―Έν„°λ¥Ό λ―Έμ„Έν•κ² μ΄λ™μ‹ν‚¤λ” κ³Όμ •μ„ λ°λ³µν•λ” κ²ƒμ…λ‹λ‹¤.

### μ•κ³ λ¦¬μ¦ μƒμ„Έ μ„¤λ… {#algorithm-details}

SPSA μ•κ³ λ¦¬μ¦μ€ λ‹¨ 1λ¶„μ΄λ©΄ μ„¤λ…μ΄ λλ‚  μ •λ„λ΅ κ°„λ‹¨ν•©λ‹λ‹¤.

1.  **ν„μ¬ νλΌλ―Έν„° λ²΅ν„° `ΞΈ`** μ—μ„ μ‹μ‘ν•©λ‹λ‹¤.
2.  κ° μ”μ†κ°€ +1 λλ” -1μ„ 1/2 ν™•λ¥ λ΅ κ°–λ” **λλ¤ λ°©ν–¥ λ²΅ν„° `Ξ”`** λ¥Ό μƒμ„±ν•©λ‹λ‹¤. (μ΄λ¥Ό 'λΌλ°λ§μ»¤ λ¶„ν¬'λΌκ³  ν•©λ‹λ‹¤.)
3.  νλΌλ―Έν„°λ³„ λ³€ν™” κ°•λ„λ¥Ό λ‚νƒ€λ‚΄λ” **μ²™λ„(scale) λ²΅ν„° `s`** λ¥Ό `Ξ”`μ™€ κ³±ν•μ—¬(`sβ™Ξ”`) μ‹¤μ  λ³€ν™”λ‰μ„ κ³„μ‚°ν•©λ‹λ‹¤.
4.  λ‘ κ°€μ§€ λ²„μ „μ νλΌλ―Έν„°, μ¦‰ **`ΞΈ + sβ™Ξ”`** μ™€ **`ΞΈ - sβ™Ξ”`** λ¥Ό κ°κ° μ μ©ν• AIλ΅ λ€κµ­μ„ μ§„ν–‰ν•©λ‹λ‹¤.
5.  λ§μ•½ `+sβ™Ξ”` λ°©ν–¥μ΄ μΉλ¦¬ν–λ‹¤λ©΄, κ·Έ λ°©ν–¥μΌλ΅ ν„μ¬ νλΌλ―Έν„° `ΞΈ`λ¥Ό μ—…λ°μ΄νΈν•©λ‹λ‹¤. μ—…λ°μ΄νΈ μ–‘μ€ `Ξµ * sβ™Ξ” / 2` μ™€ κ°™μ΄ μ•„μ£Ό μ‘μ€ κ°’(`Ξµ`λ” ν•™μµλ¥ )μ„ μ‚¬μ©ν•©λ‹λ‹¤.

μ—¬κΈ°μ„ λ¶„λ¨μ— 2κ°€ λ“¤μ–΄κ°€λ” μ΄μ λ”, μ΄ κ³Όμ •μ΄ λ‹¤λ³€μ ν•¨μμ—μ„ κΈ°μΈκΈ°λ¥Ό κ·Όμ‚¬ν•λ” 'μ¤‘μ‹¬ μ°¨λ¶„ κ·Όμ‚¬'μ™€ μν•™μ μΌλ΅ μ μ‚¬ν•κΈ° λ•λ¬Έμ…λ‹λ‹¤.

---

## 3. β™ μ‹¤μ „ νκ³Ό μ„±κ³µ μ‚¬λ΅€ {#practical-tips}

- **μ‹¤μ(float) μ—°μ‚°**: μ†μ¤μ½”λ“ μƒμ—μ„λ” μ •μ(int)μΈ νλΌλ―Έν„°λΌλ„, SPSA ν”„λ μ„μ›ν¬ λ‚΄λ¶€μ—μ„λ” λ¶€λ™μ†μμ (float)μΌλ΅ κ΄€λ¦¬ν•λ” κ²ƒμ΄ μ¤‘μ”ν•©λ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ 1 λ―Έλ§μ λ―Έμ„Έν• λ³€ν™”λ¥Ό λ„μ μ‹μΌ μµμ μ μ— μ μ§„μ μΌλ΅ λ„λ‹¬ν•  μ μμµλ‹λ‹¤.
- **μ–΄λ‹λ§(Annealing)**: νλ‹ μ΄κΈ°μ—λ” λ³€ν™”μ ν­(`s`)κ³Ό ν•™μµλ¥ (`Ξµ`)μ„ ν¬κ² μ„¤μ •ν•κ³ , νλ‹μ΄ μ§„ν–‰λ¨μ— λ”°λΌ μ μ°¨ μ¤„μ—¬λ‚κ°€λ” κ²ƒμ΄ ν¨κ³Όμ μ…λ‹λ‹¤.

μ•Όλ„¤μ°λΌμ¤ ν”„λ΅μ νΈμ—μ„λ” μ΄ SPSA μ•κ³ λ¦¬μ¦μ„ κΈ°λ°μΌλ΅ μμ²΄ νλ‹ ν”„λ μ„μ›ν¬λ¥Ό κ°λ°ν–μΌλ©°, μ΄λ¥Ό ν†µν•΄ **λ μ΄ν…(Rating)μ„ μ•½ +50μ ** κ°€λ‰ λμ–΄μ¬λ¦¬λ” μ„±κ³Όλ¥Ό κ±°λ‘μ—μµλ‹λ‹¤.

---

## 4. π λ§μΉλ©° {#conclusion}

SPSAλ” λ„κµ¬λ‚ λ– μ¬λ¦΄ λ²•ν• λ§¤μ° λ‹¨μν• μ•κ³ λ¦¬μ¦μ΄μ§€λ§, μ‡ΌκΈ° AIμ™€ κ°™μ΄ λ³µμ΅ν•κ³  κ³ μ°¨μ›μ μΈ νλΌλ―Έν„° κ³µκ°„μ—μ„λ” μ •κµν• λ² μ΄μ¦ μµμ ν™”λ³΄λ‹¤ μ¤νλ ¤ λ” λ‚μ€ μ„±λ¥μ„ λ³΄μ—¬μ¤€λ‹¤λ” μ μ—μ„ λ†€λΌμ›€μ„ μ¤λ‹λ‹¤.

κµ¬ν„μ΄ κ°„λ‹¨ν•κ³  λ‹¤μ–‘ν• κ²μ„ AIμ νλΌλ―Έν„° νλ‹μ— κ³§λ°”λ΅ μ μ©ν•  μ μλ‹¤λ” μ μ—μ„, SPSAλ” μ•μΌλ΅λ„ λ„λ¦¬ ν™μ©λ  μ μ¬λ ¥μ„ κ°€μ§„ κ°•λ ¥ν• κΈ°λ²•μ΄λΌκ³  ν•  μ μμµλ‹λ‹¤.
